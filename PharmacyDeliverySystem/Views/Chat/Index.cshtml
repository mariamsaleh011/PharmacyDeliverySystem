

@model PharmacyDeliverySystem.Models.Chat

@section Head {
    <link rel="stylesheet" href="~/css/chat.css" />
}

@section Scripts {
    <script src="~/js/chat.js"></script>
}

<div class="chat-page">
    <div class="chat-card">
        <header class="chat-header">
            <h2>@Model.Pharmacy.Name</h2>
        </header>

        <div class="chat-body" id="chat-box">
            @foreach (var msg in Model.ChatMessages.OrderBy(m => m.SentAt))
            {
                <div class="msg-row @(msg.SenderType == "Customer" ? "customer" : "pharmacist")">
                    <div class="msg-avatar">@((msg.SenderType == "Customer") ? "👤" : "💊")</div>
                    <div class="message">
                        @msg.MessageText
                        <br />
                        <small>@msg.SentAt.ToString("yyyy-MM-dd HH:mm")</small>
                    </div>
                </div>
            }
        </div>

        <footer class="chat-footer">
            <form asp-action="SendMessage" method="post">
                <input type="hidden" name="chatId" value="@Model.ChatId" />
                <input type="text" name="message" placeholder="Type a message..." required />
                <button type="submit">Send</button>
            </form>
        </footer>
    </div>
</div>
