@model PharmacyDeliverySystem.Models.Chat
@{
    Layout = "_Layout";
    ViewData["Title"] = "Pharmacy Chat";
}

@section Head {
    <link rel="stylesheet" href="~/css/pharmacy-chat.css" />
}

<div class="chat-page">
    <div class="chat-card">
        <!-- Header -->
        <header class="chat-header">
            <div class="chat-header-title">
                <span class="chat-header-avatar">💊</span>
                <h2>@Model.Customer.Name</h2>
            </div>
        </header>

        <!-- Body -->
        <div class="chat-body" id="chat-box">
            @foreach(var msg in Model.ChatMessages.OrderBy(m => m.SentAt))
            {
                <div class="msg-row @(msg.SenderType == "Pharmacy" ? "pharmacist" : "customer")">
                    <div class="msg-avatar">@((msg.SenderType == "Pharmacy") ? "💊" : "👤")</div>
                    <div class="message">@msg.MessageText
                        <br />
                        <small>@msg.SentAt.ToString("yyyy-MM-dd HH:mm")</small>
                    </div>
                </div>
            }
        </div>

        <!-- Footer -->
        <footer class="chat-footer">
            <form asp-action="SendMessage" method="post" class="chat-form">
                <input type="hidden" name="chatId" value="@Model.ChatId" />
                <input type="text" name="message" placeholder="Type a message..." required />
                <button type="submit">Send</button>
            </form>
        </footer>
    </div>
</div>

@section Scripts {
    <script src="~/js/pharmacy-chat.js"></script>
}

